<!DOCTYPE html>
<html style="height: 100%">
<head>
    <title></title>
</head>
<body style="background-color: #000; min-height: 100%; margin: 0; padding: 0;">
<div id="imgContainer" style="text-align: center; height: 100%;">
</div>
<script src="http://codeorigin.jquery.com/jquery-2.0.3.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
    var socket = io.connect('http://picturebowl.herokuapp.com');
    //var socket = io.connect('http://localhost:5000');

    var imgList = [];

    var lastTen = [];

    socket.on('debug', function (data) {
        console.log(data);
    });
    socket.on('imgs', function (data) {
        console.log(data);
        $.each(data, function(index, value) {

            imgList.push(value);
            if(lastTen.push(value) > 10)
                lastTen.shift();
        });
    });

    var i = 0;
    var showImages = function showImages() {
        console.log("calling show images");
        var src = imgList.shift();

        var length = lastTen.length;

        if(!src) {
            src = lastTen[i%length];
             console.log('last ten');
             console.log(src);
        }

        if(src) {
            $('#imgContainer').append('<img id="img' + i + '" src="' + src + '"  style="height:100%; display: none;" >');

            if(i > 0) {
                $('#img' + (i-1)).fadeOut('slow', function() {
                    console.log("fade in now");
                    console.log($('#img' + i));
                    $('#img' + i).fadeIn('slow');
                    $('#img' + (i-1)).remove();
                    i++;
                });

            }
            else {
                console.log('show image ' + i);
                console.log($('#img' + i));
                $('#img' + i).fadeIn();
                i++;
            }
        }

    };

    var show = setInterval(showImages, 10000);

</script>

</body>
</html>